caption: ç‰¹æ®Šå±æ€§ä¸æ–¹æ³• Magic Method
created: 20190720174624892
creator: liyzcj
modified: 20200404125243174
modifier: liyzcj
tags: [[Python é«˜çº§åº”ç”¨]]
title: Python ç‰¹æ®Šå±æ€§æ–¹æ³•
type: text/vnd.tiddlywiki

! ç‰¹æ®Šå±æ€§ä¸æ–¹æ³•

Python çš„ç±»æœ‰ä¸€äº›å†…ç½®çš„ç‰¹æ®Šå±æ€§ä¸æ–¹æ³•, ä¹Ÿå«''é­”æœ¯æ–¹æ³•''.

---

!! ç‰¹æ®Šå±æ€§

* å¯¹äºæ–¹æ³•å®ä¾‹: <div>

|!ç‰¹æ®Šå±æ€§|!æƒé™|!è§£é‡Š|
|`__doc__` |è¯»å†™|æ–¹æ³•çš„æè¿° |
|`__name__` |è¯»å†™|æ–¹æ³•çš„åç§°|
|`__qualname__` |è¯»å†™|å‡½æ•°çš„å…¨å([ext[New in 3.3|https://docs.python.org/3/glossary.html#term-qualified-name]]) |
|`__module__` |è¯»å†™|å‡½æ•°æ‰€å±çš„æ¨¡ç»„åç§° |
|`__defaults__` |è¯»å†™|ä¸€ä¸ªåŒ…å«æ‰€æœ‰é»˜è®¤å‚æ•°å€¼çš„ Tuple|
|`__code__` |è¯»å†™|å·²ç¼–è¯‘å‡½æ•°ä½“çš„ code å®ä¾‹ |
|`__globals__` |åªè¯»|å‡½æ•°å¯ç”¨çš„æ‰€æœ‰å…¨å±€å˜é‡çš„ Dict|
|`__dict__`|è¯»å†™|è‡ªå®šä¹‰å‡½æ•°å±æ€§çš„å­—å…¸[ext[PEP 232|https://www.python.org/dev/peps/pep-0232/]]|
|`__closure__`|åªè¯»|é—­åŒ…, è¿”å›å¤–å±‚å‡½æ•°çš„å˜é‡ cell|
|`__annotations__`|è¯»å†™|åŒ…å«å‡½æ•°å‚æ•°æ³¨é‡Šçš„ Dict ([ext[PEP 3107|https://www.python.org/dev/peps/pep-3107/]])|
|`__kwdefaults__` |è¯»å†™|åŒ…å«å…³é”®å­—é»˜è®¤å‚æ•°çš„å­—å…¸|

> Python ä¸­çš„æ–¹æ³•ä¹Ÿæ˜¯å¯¹è±¡, ç±»ä¹Ÿæ˜¯å¯¹è±¡, ''ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡''.

</div>

* å¯¹äºç±»: <div>

|!ç‰¹æ®Šå±æ€§|!è§£é‡Š|
|`__doc__` |ç±»çš„æè¿° |
|`__name__` |ç±»çš„åç§°|
|`__qualname__` |ç±»çš„å…¨å([ext[New in 3.3|https://docs.python.org/3/glossary.html#term-qualified-name]]) |
|`__module__` |ç±»æ‰€å±çš„æ¨¡ç»„åç§° |
|`__base__` |ç±»çš„åŸºç±»(çˆ¶ç±»)|
|`__bases__` |æ‰€æœ‰åŸºç±»çš„ Tuple |
|`__mro__` |æ–¹æ³•çš„è°ƒç”¨æœç´¢è·¯å¾„ Tuple (`mro()`è¿”å›List)|
|`__abstractmethods__`|ä¸€ä¸ªåŒ…å«æŠ½è±¡æ–¹æ³•çš„set(ä»…æŠ½è±¡ç±»)|
|`__class__`|æ‰€å±çš„ç±», ä¸€èˆ¬ç±»å±äºtype|
|`__dict__`|ç±»çš„é™æ€å±æ€§ä»¥åŠå®ç°çš„æ–¹æ³•|

> ğŸ’¡ å¯ä»¥ä½¿ç”¨ `vars()` æ–¹æ³•è·å–ä¸€ä¸ªå¯¹è±¡çš„ `__dict__`.

</div>

* å¯¹äºå®ä¾‹: <div>

|!ç‰¹æ®Šå±æ€§|!è§£é‡Š|
|`__doc__` |ç±»çš„æè¿°|
|`__module__`|ç±»æ‰€å±çš„ module |
|`__class__`|æ‰€å®ä¾‹åŒ–çš„ç±»|
|`__dict__`|å®ä¾‹æ‰€æœ‰çš„å±æ€§çš„å­—å…¸|

> æ³¨æ„å®ä¾‹çš„ `__dict__` ä¸ç±»çš„ `__dict__` ä¸åŒ.


</div>

---

!! ç‰¹æ®Šæ–¹æ³•

|!ç‰¹æ®Šæ–¹æ³•|!è°ƒç”¨æ–¹å¼|!è§£é‡Š|
|`__new__(cls [,...])`|instance = ~MyClass(arg1, arg2)|åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™è¢«è°ƒç”¨|
|`__init__(self [,...])`|instance = ~MyClass(arg1, arg2)|åœ¨åˆ›å»ºå®ä¾‹çš„æ—¶å€™è¢«è°ƒç”¨|
|`__cmp__(self, other)`|self == other, self > other, ç­‰|åœ¨ä½¿ç”¨æ¯”è¾ƒç¬¦çš„æ—¶å€™è°ƒç”¨|
|`__pos__(self)`|+self|ä¸€å…ƒåŠ è¿ç®—ç¬¦|
|`__neg__(self)`|-self|ä¸€å…ƒå‡è¿ç®—ç¬¦|
|`__invert__(self)`|~self|å–åè¿ç®—ç¬¦|
|`__index__(self)`|x[self]|å¯¹è±¡è¢«ä½œä¸ºç´¢å¼•ä½¿ç”¨çš„æ—¶å€™|
|`__nonzero__(self)`|bool(self)|å¯¹è±¡çš„å¸ƒå°”å€¼|
|`__getattr__(self, name)`|self.name # name ä¸å­˜åœ¨|è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§æ—¶|
|`__setattr__(self, name, val)`|self.name = val|å¯¹ä¸€ä¸ªå±æ€§èµ‹å€¼æ—¶|
|`__delattr__(self, name)`|del self.name|åˆ é™¤ä¸€ä¸ªå±æ€§æ—¶|
|`__getattribute(self, name)`|self.name|è®¿é—®ä»»ä½•å±æ€§æ—¶|
|`__getitem__(self, key)`|self[key]|ä½¿ç”¨ç´¢å¼•è®¿é—®å…ƒç´ æ—¶|
|`__setitem__(self, key, val)`|self[key] = val|å¯¹æŸä¸ªç´¢å¼•å€¼èµ‹å€¼æ—¶|
|`__delitem__(self, key)`|del self[key]|åˆ é™¤æŸä¸ªç´¢å¼•å€¼æ—¶|
|`__iter__(self)`|for x in self|è¿­ä»£æ—¶|
|`__contains__(self, value)`| value in self, value not in self|ä½¿ç”¨ in æ“ä½œæµ‹è¯•å…³ç³»æ—¶|
|`__concat__(self, value)`|self + other|è¿æ¥ä¸¤ä¸ªå¯¹è±¡æ—¶|
|`__call__(self [,...])`|self(args)|â€œè°ƒç”¨â€å¯¹è±¡æ—¶|
|`__enter__(self)` |with self as x:|with è¯­å¥ç¯å¢ƒç®¡ç†|
|`__exit__(self, exc, val, trace)`|with self as x:|with è¯­å¥ç¯å¢ƒç®¡ç†|
|`__getstate__(self)`|pickle.dump(pkl_file, self)|åºåˆ—åŒ–æ—¶|
|`__setstate__(self)`|data = pickle.load(pkl_file)|åºåˆ—åŒ–è¯»å–æ—¶|

<<<
å‚è€ƒæ–‡æ¡£:

* [ext[Python é­”æœ¯æ–¹æ³•æŒ‡å—|https://pycoders-weekly-chinese.readthedocs.io/en/latest/issue6/a-guide-to-pythons-magic-methods.html#python]]

* [ext[Python å®˜æ–¹æ–‡æ¡£|https://docs.python.org/3/reference/datamodel.html#basic-customization]]

* [ext[ä¸€ç¯‡æ–‡ç« ææ‡‚Pythonä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹|http://yangcongchufang.com/%E9%AB%98%E7%BA%A7python%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/python-object-class.html#dir5]]

* [ext[Python é¢å‘å¯¹è±¡(è¿›é˜¶ç¯‡)|https://www.imooc.com/article/3066]]